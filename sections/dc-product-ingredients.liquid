{{ 'dc-img-video-text.css' | asset_url | stylesheet_tag }}
{{ 'dc-product-ingredients.css' | asset_url | stylesheet_tag }}

{% if template == "product" %}
<script>
  var productIngredients = "{{ product.metafields.my_fields.all_ingredients | replace: " ", "" }}"
  console.log("productIngredients : "+productIngredients);
  
  var ingredientsArray = productIngredients.split(",");
  console.log("ingredientsArray : "+ingredientsArray);
  for(var i = 0; i < ingredientsArray.length; i++) {
    console.log("."+ingredientsArray[i]);
    var ingredientName  = ingredientsArray[i]
  	$("."+ingredientName).removeClass("no-disp");
    $("."+ingredientName+"-details").removeClass("no-disp");
  }
</script>
{% endif %}

<div class="image-video-text-block marg-top-xl marg-bottom-xl">
  <div class="container">
    <div class="flex-box justify-between align-center rel image-text-wrapper {% if section.settings.media_alignment == 'right' %}rev-cols{% endif %}" style="background-color: {{ section.settings.ingredient_title_background }}">
      <div class="ingredient-details-block rel" style="background-color: {{ section.settings.ingredient_details_background }}">
		{% for block in section.blocks %}
        <div class="ingredient-details-wrapper {{ block.settings.ingredient_name }}-details no-disp">
          <p class="ingredient-details-title">{{ block.settings.ingredient_name }}</p>
          <div class="ingredient-details-text">{{ block.settings.ingredient_details }}</div>
          <img class="ingredient-image" src="{{ block.settings.ingredient_image | img_url: '480x' }}" alt="{{ block.settings.ingredient_name }} image" loading="lazy">
        </div>
        {% endfor %}
      </div>
      <div class="ingredient-title-block rel">
        <span class="subheading-text">{{ section.settings.section_subtitle }}</span>
        <h2 class="heading-text tk-le-monde-livre-classic-byol" style="margin-bottom: 24px;">{{ section.settings.section_title }}</h2>
        {% for block in section.blocks %}
          <div class="ingredient-label {{ block.settings.ingredient_name }} no-disp">
            <input type="radio" name="ingredients-name" class="ingredients-radio" id="{{ block.settings.ingredient_name }}">
            <label class="" for="{{ block.settings.ingredient_name }}">
              {{ block.settings.ingredient_name }}
            </label>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "DC Product Ingredients",
    "settings": [
      {
        "label": "Ingredient Details Background Color",
        "id": "ingredient_details_background",
        "type": "color"
      },
	  {
        "label": "Ingredient Title Background Color",
        "id": "ingredient_title_background",
        "type": "color"
      },
	  {
        "type": "radio",
        "id": "media_alignment",
        "label": "Media alignment",
        "options": [
          {
            "value": "left",
            "label": "Left"
          },
          {
            "value": "right",
            "label": "Right"
          }
        ],
        "default": "right"
      },
	  {
          "label": "Section sub title",
          "id": "section_subtitle",
          "type": "text"
      },
	  {
          "label": "Section title",
          "id": "section_title",
          "type": "text"
      }
	],
	"blocks": [
      {
        "type": "select",
        "name": "Ingredients",
        "settings": [
            {
              "label": "Ingredient Name",
              "id": "ingredient_name",
              "type": "text"
            },
            {
              "label": "Ingredient Details",
              "id": "ingredient_details",
              "type": "html"
            },
			{
              "label": "Ingredient Image",
              "id": "ingredient_image",
              "type": "image_picker"
            }
        ]
      }
    ],
	"presets": [
    {
      "name": "DC Product Ingredients"
    }
  ]
  }
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}
